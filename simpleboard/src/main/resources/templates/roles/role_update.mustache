<!DOCTYPE html>
<html lang="en">
<html>
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>My Awesome Site</title>
    </head>
    <body>
        <header>
            <h1>Welcome to Role update page</h1>
        </header>
        <div id="content">
            <p>Hello, World!</p>
            {{#role}}
            <div id="role_div">
                <label>role name : </label><input type="text" name="name" value="{{name}}"><br>
                <label>role desc : </label><input type="text" name="desc" value="{{desc}}">
                {{#privileges}}
                <div>
                    <label>role name : {{name}}</label><br>
                    <label>role desc : {{desc}}</label>
                </div>
                {{/privileges}}
            </div>
            {{/role}}
        </div>
        <div>
        <button type="button" onclick="doUpdate({{role.id}})">do update!</button>
        </div>
        <div>
        <button type="button" onclick="location.href='/roles'">go back to role list</button>
        </div>
        <script>
        function doUpdate(role_id)
        {
            var http = new XMLHttpRequest();
            var url_to = window.location.origin + "/roles/" + role_id;
            http.open("POST", url_to);
            http.setRequestHeader("content-type", "application/x-www-form-urlencoded");

            var role_div = document.getElementById("role_div");
            var role_name = document.getElementsByName('name')[0].value;
            var role_desc = document.getElementsByName("desc")[0].value;
            var requset_body = 
                "name="+role_name
                + "&"
                + "desc="+role_desc
            ;
            console.log("send req body : "+requset_body);
            http.send(requset_body);
        }
        </script>
    </body>
</html>